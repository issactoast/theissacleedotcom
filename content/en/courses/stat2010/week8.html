---
date: "2020-02-10T00:00:00+01:00"
draft: false
linktitle: Week 8 - Testing for the mean
menu:
  stat2010:
    parent: Contents
    weight: 8
title: Lab 8 - Tests of Significance
type: docs
weight: 8    # related to next page to show
---



<p>The class video is attached here so that you can watch my lecture again when you prepare the exams.</p>
<ul>
<li>If you have questions about my lecture, please use <strong>the comment section</strong> at the bottom of this document.</li>
</ul>
<div align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/YUW7LzxG1LM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="are-you-a-good-pitcher" class="section level2">
<h2>Are you a good pitcher?</h2>
<p><img src="https://ca-times.brightspotcdn.com/dims4/default/cea493c/2147483647/strip/true/crop/2048x1576+0+0/resize/840x646!/quality/90/?url=https%3A%2F%2Fcalifornia-times-brightspot.s3.amazonaws.com%2F3f%2Fea%2F73843d30656cefde4d6f5c5479af%2Fla-sp-clayton-kershaw-dodgers-wre0037975682-20160421" /></p>
<p>I have a friend who can throw a ball really fast. But I always doubt about what he said because he always says,</p>
<pre><code>I can throw a fastball like 90 mph!</code></pre>
<p>Well, I don’t buy it, because</p>
<ol style="list-style-type: decimal">
<li>If he can do it, he should go to the professional baseball league instead of being my friend. :/</li>
<li>After I measured his 20 throws, here is what I got:</li>
</ol>
<pre><code>##  [1] 77 80 82 75 80 81 78 78 78 78 79 78 78 80 81 79 78 78 78 84</code></pre>
<p>Average 79 mph! Oh, common, this is not even close! However, my friend did not admit he is wrong and say, “Well, today is the very unlucky day! But usually, my ball speed is around 90 mph!”</p>
<div id="one-side-test" class="section level3">
<h3>One side test</h3>
<p>We don’t believe what he is saying because <strong>the probability that the average of the thrown 20 ball speeds is around 79 is very very low if his opinion is true!</strong></p>
<p>Let us describe the situation using some statistical notation.</p>
<p><span class="math display">\[
H_0: \mu = 90 \ mph \quad vs. \quad H_a: \mu &lt; 90 \ mph
\]</span>
<span class="math inline">\(H_0\)</span> is a null hypothesis, which represents what my friend insists about his ball speed. <span class="math inline">\(H_a\)</span> is an alternative hypothesis, which represents my opinion.</p>
<p>If we assume that the distribution of his pitch speed follows a Normal distribution, with <strong>UNKNOWN</strong> mean <span class="math inline">\(\mu\)</span> and <strong>KNOWN</strong> standard deviation <span class="math inline">\(\sigma\)</span> (in this example 2), we have studied that the distribution of <span class="math inline">\(\overline{X}\)</span> follows a Normal distribution as follows:
<span class="math display">\[
\overline{X} \sim \mathcal{N} (\mu, \frac{\sigma}{\sqrt{n}} )
\]</span></p>
<p>Thus, if his opinion is TRUE; <span class="math inline">\(\mu = 90\)</span>, then we have
<span class="math display">\[
\overline{X} \sim \mathcal{N} (90, \frac{2}{\sqrt{20}} )
\]</span>
In this situation, what is the probability that I can see the observation like <span class="math inline">\(\overline{x} = 79\)</span>? Using statistical notation, I can write it down as follows:
<span class="math display">\[
P(\overline{X} \le 79) = ?
\]</span>
To calculate the probability, I need to convert the number into the standard Normal scale, because we can calculate the probability only on the standard Normal distribution scale. So let me use the standardization formula!
<span class="math display">\[
z = \frac{79 - 90}{2/\sqrt{20}} \approx -24.6
\]</span>
Well, now I can see, this is a very, very rare event if his real ball speed is 90 mph. Because, in our standard Normal table, the probability that corresponds to z score -3.4 was 0.0003, in other words,
<span class="math display">\[
P(\overline{X} \le 79) = P(Z \le -24.6) \  \ll  \ P(Z \le -3.4) = 0.0003
\]</span>
where I use <span class="math inline">\(\ll\)</span> symbol to say that it is wayyyyy less than the right-hand side. Thus, I conclude that his opinion is total nonsense, but I want to say it more academical way, so I would say as follow:</p>
<p><strong>I can reject <span class="math inline">\(H_0\)</span> (His opinion) based on my sample.</strong></p>
</div>
<div id="one-side-test-unknown-sigma" class="section level3">
<h3>One side test (Unknown <span class="math inline">\(\sigma\)</span>)</h3>
<p>What if we don’t know about the population <span class="math inline">\(\sigma\)</span>? Remember, we used <span class="math inline">\(t\)</span> distribution for the construction of confidence intervals. Similarly, we will use the sample standard deviation, <span class="math inline">\(s\)</span>, for the <span class="math inline">\(\sigma\)</span> value in the standardization formula! Thus, we have the following conversion value, which I denote <span class="math inline">\(t\)</span>, as follows:
<span class="math display">\[
t = \frac{79 - 90}{1.974/\sqrt{20}} \approx -24.92
\]</span>
where <span class="math inline">\(1.974\)</span> is a sample standard deviation of my friend’s throwings. This converted value follows <span class="math inline">\(t\)</span> distribution with degree of freedom <span class="math inline">\(19\)</span>, which gives a probability
<span class="math display">\[
P(T_{19} \le -24.92) \ll P(T\le -3.883)=0.0005 
\]</span>
Note that I can not use the notation <span class="math inline">\(Z\)</span> since it does not follow the standard Normal distribution but <span class="math inline">\(t\)</span> distribution with d.f. 19.</p>
</div>
<div id="statistical-terms" class="section level3">
<h3>Statistical terms</h3>
<div id="test-statistic" class="section level4">
<h4>Test statistic</h4>
<p>Above, we have calculated the z-score assuming his opinions (<span class="math inline">\(H_0\)</span>) is true, if I write this down using symbolic notations,
<span class="math display">\[
z = \frac{79 - 90}{2/\sqrt{20}} \Longrightarrow  z = \frac{\overline{x} - \mu_0}{\sigma / \sqrt{n}}
\]</span>
We call this special standardization formula <strong><span class="math inline">\(z\)</span> test statistic</strong>, it is special since we use imaginary <span class="math inline">\(\mu\)</span>. Likewise, we have <strong><span class="math inline">\(t\)</span> test statistic</strong>
<span class="math display">\[
t = \frac{79 - 90}{1.974/\sqrt{20}} \Longrightarrow  t = \frac{\overline{x} - \mu_0}{s / \sqrt{n}}
\]</span></p>
</div>
<div id="p-value" class="section level4">
<h4>P-value</h4>
<p>After calculating the test statistic, what we have tried to find was the probability that the observation <span class="math inline">\(\overline{x}\)</span> can happen in the assuming distribution, which was, in our case,
<span class="math display">\[
P(\overline{X} \le 79) \quad when \ \mu = 90
\]</span>
We call this probability <strong><span class="math inline">\(p\)</span>-value</strong>.</p>
</div>
</div>
<div id="testing-in-sas" class="section level3">
<h3>Testing in SAS</h3>
<p>Let us do this in SAS now.</p>
<pre class="sas"><code>data pitch ;
input speed ;
datalines;
* note: copy and paste data in here ;
;
run;

proc print data = pitch;
run;

proc means data = pitch;
var speed;
run;</code></pre>
<pre class="sas"><code>                                      The MEANS Procedure

                                  Analysis Variable : speed

               N            Mean         Std Dev         Minimum         Maximum
              ------------------------------------------------------------------
              20      79.0000000       1.9735088      75.0000000      84.0000000
              ------------------------------------------------------------------</code></pre>
<div id="z-test-in-sas" class="section level4">
<h4>Z-Test in SAS</h4>
<p>Using the above result we hvae the information about the <span class="math inline">\(n\)</span> and <span class="math inline">\(\overline{x}\)</span>. Since SAS does not provide the <em>z-test</em>, let just make our own code for the test!</p>
<pre class="sas"><code>%let numObs= 20;
%let smean = 79;
%let sigma = 2;
%let mu0   = 90;
%let Side  = L;
%let slevel= 0.05;
title &quot;Test for population mean&quot;;

data zTestMean;
n = &amp;NumObs;
x_bar = &amp;smean;
SE = &amp;sigma / sqrt(n);
z = (x_bar - &amp;mu0) / SE;
alpha = &amp;slevel;

/* p-Value */
Side = &quot;&amp;Side&quot;;
if Side=&quot;L&quot; then                      /* one-sided, lower tail */
   pValue = cdf(&quot;normal&quot;, z);
   label pValue = &quot;Pr(Z &lt; z)&quot;;
else if Side=&quot;U&quot; then                 /* one-sided, upper tail */
   pValue = 1 - cdf(&quot;normal&quot;, z);
   label pValue = &quot;Pr(Z &gt; z)&quot;;
else if Side=&quot;2&quot; then
   pValue = 2*(1-cdf(&quot;normal&quot;, abs(z))); /* two-sided */
   label pValue = &quot;Pr(Z &gt; |z|)&quot;;

/* Test result */
length result $ 16;
if pValue &lt;= alpha then
   result = &quot;Reject Ho&quot;;
else if pValue &gt; alpha then
   result = &quot;Cannot reject Ho&quot;;
format pValue PVALUE6.4 z 7.4 result $16.;
label result = &quot;Test result&quot;;
label alpha = &quot;Sig. level&quot;;
run ;

proc print data = zTestMean label noobs; run;
run;</code></pre>
<p>The result will be as follows;</p>
<pre class="sas"><code>                             Test for population mean


                                      Sig.            Pr(Z &gt;
  n    x_bar       SE            z    level    Side     |z|)     Test result
----------------------------------------------------------------------------
 20      79     0.44721    -24.597     0.05     L      &lt;.0001    Reject Ho
----------------------------------------------------------------------------
</code></pre>
</div>
<div id="t-test-in-sas" class="section level4">
<h4>t-Test in SAS</h4>
<p>I know the z-test in SAS is actually really burdensome, I would rather do it by hand. However, it will be useful for you to have the code for your future usage. For <em>t-test</em> SAS provides us with t-test result by using <code>proc univariate</code>;</p>
<pre class="sas"><code>proc univariate mu0 = 90 data = pitch;
var speed;
run;</code></pre>
<pre class="sas"><code>                                  Tests for Location: Mu0=90

                       Test           -Statistic-    -----p Value------

                       Student&#39;s t    t  -24.9269    Pr &gt; |t|    &lt;.0001
                       Sign           M       -10    Pr &gt;= |M|   &lt;.0001
                       Signed Rank    S      -105    Pr &gt;= |S|   &lt;.0001
</code></pre>
<p>Note that SAS will give you two-side test p-value, so you need to adjust the result into your test situation.</p>
</div>
</div>
</div>
